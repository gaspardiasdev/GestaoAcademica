<!DOCTYPE html>
<html lang="pt">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GestÃ£o AcadÃ©mica</title>
<style>
* {margin:0; padding:0; box-sizing:border-box;}
body {font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Oxygen,Ubuntu,Cantarell,sans-serif; background:linear-gradient(135deg,#667eea 0%,#764ba2 100%); min-height:100vh; padding:20px;}
.container {max-width:1200px; margin:0 auto; background:white; border-radius:20px; box-shadow:0 20px 60px rgba(0,0,0,0.3); overflow:hidden;}
.header {background:linear-gradient(135deg,#667eea 0%,#764ba2 100%); color:white; padding:30px;}
.header h1 {font-size:2.5em; margin-bottom:10px;}
.header p {opacity:0.9;}
.tabs {display:flex; background:#f7f7f7; border-bottom:2px solid #e0e0e0;}
.tab {flex:1; padding:20px; border:none; background:none; font-size:1.1em; font-weight:600; cursor:pointer; transition:all 0.3s; color:#666;}
.tab:hover {background:#e8e8e8;}
.tab.active {background:white; color:#667eea; border-bottom:3px solid #667eea;}
.content {padding:30px;}
.tab-content {display:none;}
.tab-content.active {display:block;}
.semester-selector {margin-bottom:30px; display:flex; align-items:center; gap:15px;}
.semester-selector label {font-weight:600; color:#333;}
.semester-selector select, input[type="number"], input[type="text"] {padding:10px 15px; border:2px solid #e0e0e0; border-radius:8px; font-size:1em; transition:border 0.3s;}
.semester-selector select:focus, input:focus {outline:none; border-color:#667eea;}
.btn {padding:12px 24px; border:none; border-radius:8px; font-size:1em; font-weight:600; cursor:pointer; transition:all 0.3s;}
.btn-primary {background:#667eea; color:white;}
.btn-primary:hover {background:#5568d3; transform:translateY(-2px); box-shadow:0 5px 15px rgba(102,126,234,0.4);}
.btn-danger {background:#ef4444; color:white; padding:8px 12px; font-size:0.9em;}
.btn-danger:hover {background:#dc2626;}
.btn-success {background:#10b981; color:white;}
.btn-success:hover {background:#059669;}
.subject-card {background:#f9fafb; border:2px solid #e5e7eb; border-radius:12px; padding:25px; margin-bottom:20px;}
.subject-header {display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;}
.subject-header h3 {font-size:1.5em; color:#1f2937;}
.grade-display {display:flex; align-items:center; gap:15px;}
.final-grade {padding:12px 20px; border-radius:8px; font-size:1.3em; font-weight:bold;}
.grade-pass {background:#d1fae5; color:#065f46;}
.grade-fail {background:#fee2e2; color:#991b1b;}
.subject-grid {display:grid; grid-template-columns:repeat(auto-fit, minmax(250px, 1fr)); gap:15px; margin-bottom:20px;}
.subject-section {background:white; padding:20px; border-radius:8px; border:1px solid #e5e7eb;}
.subject-section h4 {margin-bottom:15px; color:#374151;}
.input-group {margin-bottom:15px;}
.input-group label {display:block; font-size:0.9em; color:#6b7280; margin-bottom:5px;}
.trabalhos-list {margin-top:10px;}
.trabalho-item {display:flex; justify-content:space-between; align-items:center; background:#f3f4f6; padding:10px; border-radius:6px; margin-bottom:8px;}
.finance-card {background:linear-gradient(135deg,#667eea 0%,#764ba2 100%); color:white; padding:30px; border-radius:12px; margin-bottom:20px;}
.finance-card h3 {margin-bottom:20px; font-size:1.5em;}
.finance-grid {display:grid; grid-template-columns:repeat(auto-fit, minmax(200px, 1fr)); gap:15px; margin-bottom:20px;}
.finance-stat {background:rgba(255,255,255,0.2); padding:20px; border-radius:8px; backdrop-filter:blur(10px);}
.finance-stat p {font-size:0.9em; opacity:0.9; margin-bottom:8px;}
.finance-stat h4 {font-size:2em;}
.material-card {background:#f0fdf4; border:2px solid #86efac; padding:30px; border-radius:12px;}
.material-header {display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;}
.material-list {margin-bottom:20px;}
.material-item {background:white; padding:20px; border-radius:8px; margin-bottom:10px; display:flex; justify-content:space-between; align-items:center; border:1px solid #d1fae5;}
.material-info h4 {color:#065f46; margin-bottom:5px;}
.material-info p {color:#6b7280; font-size:0.9em;}
.empty-state {text-align:center; padding:60px 20px; color:#9ca3af;}
.empty-state svg {width:80px; height:80px; margin-bottom:20px; opacity:0.5;}
.summary-card {background:linear-gradient(135deg,#f093fb 0%,#f5576c 100%); color:white; padding:30px; border-radius:12px; margin-top:20px;}
.progress-bar-container {
    background: #f3f4f6;
    border-radius: 8px;
    margin-bottom: 10px;
    overflow: hidden;
    height: 35px;
    display: flex;
    align-items: center;
    border: 1px solid #e5e7eb;
}
.progress-bar {
    height: 100%;
    background: linear-gradient(90deg, #667eea, #764ba2);
    display: flex;
    align-items: center;
    justify-content: flex-end;
    padding: 0 10px;
    font-weight: 700;
    color: white;
    transition: width 0.8s ease-out;
}
.progress-label {
    width: 80px;
    font-weight: 600;
    color: #333;
    padding-left: 5px;
}
.semester-progress-item {
    display: flex;
    align-items: center;
    gap: 10px;
}
/* CSS para a lista detalhada */
.estatistica-item {
    padding: 15px;
    border-bottom: 1px solid #e5e7eb;
    display: flex;
    justify-content: space-between;
    align-items: center;
}
.estatistica-item:last-child {
    border-bottom: none;
}
.estatistica-item .grade {
    padding: 8px 15px;
    border-radius: 6px;
    font-weight: bold;
}
.estatistica-item .grade.pass {
    background:#d1fae5; 
    color:#065f46;
}
.estatistica-item .grade.fail {
    background:#fee2e2; 
    color:#991b1b;
}
@media (max-width:768px){
    body {padding:10px;}
    .container {border-radius:15px;}
    .header {padding:20px;}
    .header h1{font-size:1.6em;}
    .header p {font-size:0.9em;}
    .tabs {flex-direction:row; overflow-x:auto;}
    .tab {padding:15px 10px; font-size:0.95em; white-space:nowrap;}
    .content {padding:15px;}
    .semester-selector {flex-direction:column; align-items:stretch;}
    .semester-selector select, .semester-selector button {width:100%;}
    .subject-grid{grid-template-columns:1fr;}
    .subject-header {flex-direction:column; align-items:flex-start; gap:15px;}
    .grade-display {width:100%; justify-content:space-between;}
    .finance-card {padding:20px;}
    .finance-card h3 {font-size:1.3em;}
    .finance-grid {grid-template-columns:1fr;}
    .material-header {flex-direction:column; gap:10px;}
    .material-header button {width:100%;}
    .material-item {flex-direction:column; align-items:flex-start; gap:15px;}
    .material-item button {width:100%;}
    .material-info {width:100%;}
    .finance-stat h4 {font-size:1.5em;}
    .summary-card {padding:20px;}
    .btn {width:100%; justify-content:center;}
    input[type="file"] {width:100%; margin-top:10px;}
}
</style>
</head>
<body>
<div class="container">
    <div class="header">
        <h1>ğŸ“š GestÃ£o AcadÃ©mica</h1>
        <p>Organiza as tuas cadeiras e finanÃ§as</p>
    </div>

    <div class="tabs">
Â  Â  Â  Â  <button class="tab active" onclick="switchTab('cadeiras')">ğŸ“Š Cadeiras</button>
Â  Â  Â  Â  <button class="tab" onclick="switchTab('financas')">ğŸ’° FinanÃ§as</button>
Â  Â  Â  Â  <button class="tab" onclick="switchTab('estatisticas')">ğŸ“ˆ EstatÃ­sticas</button>
Â  Â  </div>

    <div class="content">
Â  Â  Â  Â  <div id="cadeiras" class="tab-content active">
Â  Â  Â  Â  Â  Â  <div class="semester-selector">
Â  Â  Â  Â  Â  Â  Â  Â  <label>Semestre:</label>
Â  Â  Â  Â  Â  Â  Â  Â  <select id="semester-select" onchange="renderSubjects()">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="1">1Âº Semestre</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="2">2Âº Semestre</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="3">3Âº Semestre</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="4">4Âº Semestre</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="5">5Âº Semestre</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="6">6Âº Semestre</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="7">7Âº Semestre</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="8">8Âº Semestre</option>
Â  Â  Â  Â  Â  Â  Â  Â  </select>
Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn btn-primary" onclick="addSubject()" style="margin-left:auto;">+ Adicionar Cadeira</button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div id="subjects-container"></div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div id="financas" class="tab-content">
Â  Â  Â  Â  Â  Â  <div class="finance-card">
Â  Â  Â  Â  Â  Â  Â  Â  <h3>ğŸ’³ Propinas</h3>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="finance-grid">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="input-group">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label>Valor Mensal (kz)</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="number" id="propina-mensal" onchange="saveFinances()" placeholder="0.00" step="0.01">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="input-group">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label>Meses Totais</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="number" id="meses-totais" onchange="saveFinances()" placeholder="10">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="input-group">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label>Meses Pagos</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="number" id="meses-pagos" onchange="saveFinances()" placeholder="0">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="finance-grid">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="finance-stat">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p>Total Pago</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h4 id="total-pago">0.00 kz</h4>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="finance-stat">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p>Restante a Pagar</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h4 id="restante-pagar">0.00 kz</h4>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="finance-stat">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p>Progresso</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h4 id="progresso">0%</h4>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div class="material-card">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="material-header">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h3>ğŸ“– Material Escolar e Gastos</h3>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn btn-success" onclick="toggleMaterialForm()">+ Adicionar Gasto</button>
Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  <div id="material-form" style="display:none; background:white; padding:20px; border-radius:8px; margin-bottom:20px; border:2px solid #86efac;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h4 style="color:#065f46; margin-bottom:15px;">Novo Gasto</h4>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="subject-grid">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="input-group">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label>Nome do Gasto</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" id="new-material-nome" placeholder="Ex: Cadernos, FotocÃ³pias...">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="input-group">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label>PreÃ§o UnitÃ¡rio (kz)</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="number" id="new-material-preco" placeholder="0.00" step="0.01">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="input-group">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label>Quantidade</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="number" id="new-material-qtd" placeholder="1" min="1" value="1">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="input-group">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label>MÃªs</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <select id="new-material-mes">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="1">Janeiro</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="2">Fevereiro</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="3">MarÃ§o</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="4">Abril</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="5">Maio</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="6">Junho</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="7">Julho</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="8">Agosto</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="9">Setembro</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="10">Outubro</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="11">Novembro</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="12">Dezembro</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </select>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="input-group">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label>Semana do MÃªs</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <select id="new-material-semana">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="1">1Âª Semana</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="2">2Âª Semana</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="3">3Âª Semana</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="4">4Âª Semana</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </select>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="display:flex; gap:10px; margin-top:15px;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn btn-success" onclick="saveNewMaterial()">ğŸ’¾ Guardar</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn" style="background:#6b7280; color:white;" onclick="toggleMaterialForm()">Cancelar</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  <div style="background:white; padding:15px; border-radius:8px; margin-bottom:20px; display:flex; gap:15px; flex-wrap:wrap; align-items:center;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span style="font-weight:600; color:#065f46;">Filtrar:</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <select id="filter-mes" onchange="applyFilters()" style="padding:8px; border:2px solid #86efac; border-radius:6px;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="">Todos os Meses</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="1">Janeiro</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="2">Fevereiro</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="3">MarÃ§o</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="4">Abril</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="5">Maio</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="6">Junho</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="7">Julho</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="8">Agosto</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="9">Setembro</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="10">Outubro</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="11">Novembro</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="12">Dezembro</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </select>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <select id="filter-semana" onchange="applyFilters()" style="padding:8px; border:2px solid #86efac; border-radius:6px;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="">Todas as Semanas</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="1">1Âª Semana</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="2">2Âª Semana</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="3">3Âª Semana</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="4">4Âª Semana</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </select>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn btn-primary" onclick="clearFilters()" style="padding:8px 16px; font-size:0.9em;">Limpar Filtros</button>
Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  <div id="material-list" class="material-list"></div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="finance-stat" style="background:white;color:#10b981;border:2px solid #86efac;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p style="color:#6b7280;">Total Gasto em Material</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h4 id="total-material">0.00 kz</h4>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div class="summary-card">
Â  Â  Â  Â  Â  Â  Â  Â  <h3>ğŸ“Š Resumo Total</h3>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="finance-grid">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="finance-stat">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p>Total Gasto (Propinas + Material)</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h4 id="total-gasto">0.00 kz</h4>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="finance-stat">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p>Total Previsto</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h4 id="total-previsto">0.00 kz</h4>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div style="margin-top:20px; display:flex; gap:10px; flex-wrap:wrap;">
Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn btn-success" onclick="exportData()">ğŸ’¾ Exportar Dados</button>
Â  Â  Â  Â  Â  Â  Â  Â  <input type="file" accept=".json" onchange="importData(this.files[0])">
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  <div id="estatisticas" class="tab-content">
Â  Â  Â  Â  Â  Â  <h2>ğŸ“Š Dashboard de EstatÃ­sticas</h2>
Â  Â  Â  Â  Â  Â  <p style="margin-bottom:20px; color:#6b7280;">Resumo da sua performance acadÃ©mica em todos os semestres.</p>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="finance-grid" style="margin-bottom:30px;">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="finance-stat" style="background:#e0f2fe; color:#0284c7; border:1px solid #7dd3fc;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p style="color:#6b7280;">MÃ©dia Geral (Todas as Cadeiras)</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h4 id="est-media-geral">0.00</h4>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="finance-stat" style="background:#d1fae5; color:#065f46; border:1px solid #a7f3d0;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p style="color:#6b7280;">Cadeiras Aprovadas / Reprovadas</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h4 id="est-aprov-reprov">0 / 0</h4>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="finance-stat" style="background:#ffedd5; color:#9a3412; border:1px solid #fed7aa;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p style="color:#6b7280;">Melhor Cadeira</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h4 id="est-melhor-cadeira">N/A</h4>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="finance-stat" style="background:#fee2e2; color:#991b1b; border:1px solid #fecaca;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p style="color:#6b7280;">Pior Cadeira</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h4 id="est-pior-cadeira">N/A</h4>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h3>ğŸ“ˆ Progresso por Semestre</h3>
Â  Â  Â  Â  Â  Â  <p style="color:#6b7280;">MÃ©dia de todas as cadeiras por semestre</p>
Â  Â  Â  Â  Â  Â  <div id="est-progresso-semestre" style="margin-top:15px; display:flex; flex-direction:column; gap:15px;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <br>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h3>ğŸ¯ EstatÃ­sticas Detalhadas</h3>
Â  Â  Â  Â  Â  Â  <div id="est-detalhada" class="material-list">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  </div>
Â  Â  </div>
</div>

<script>
let subjects = {};
let finances = {propinaMensal:0, mesesTotais:0, mesesPagos:0, materialEscolar:[]};

function loadData() {
    const subjectsData = localStorage.getItem('subjects');
    const financesData = localStorage.getItem('finances');
    if(subjectsData) subjects = JSON.parse(subjectsData);
    if(financesData) finances = JSON.parse(financesData);
    renderSubjects();
    renderFinances();
}

function saveData() {
    localStorage.setItem('subjects', JSON.stringify(subjects));
    localStorage.setItem('finances', JSON.stringify(finances));
}

function exportData() {
    const data = {subjects, finances};
    const blob = new Blob([JSON.stringify(data,null,2)], {type:"application/json"});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'gestao_academica_backup.json';
    a.click();
    URL.revokeObjectURL(url);
}

function importData(file) {
    const reader = new FileReader();
    reader.onload = function(e) {
        const data = JSON.parse(e.target.result);
        subjects = data.subjects || {};
        finances = data.finances || {};
        saveData();
        renderSubjects();
        renderFinances();
    };
    reader.readAsText(file);
}

function switchTab(tabName) {
Â  Â  document.querySelectorAll('.tab').forEach(tab=>tab.classList.remove('active'));
Â  Â  document.querySelectorAll('.tab-content').forEach(content=>content.classList.remove('active'));
Â  Â  event.target.classList.add('active');
Â  Â  document.getElementById(tabName).classList.add('active');
Â  Â  if(tabName === 'estatisticas') renderEstatisticas(); // CHAMA A NOVA FUNÃ‡ÃƒO
}

function addSubject() {
    const name = prompt('Nome da cadeira:');
    if(!name) return;
    const tipo = confirm('Esta cadeira Ã© ANUAL?\n(OK = Anual, Cancelar = Semestral)') ? 'anual' : 'semestral';
    const semester = document.getElementById('semester-select').value;
    if(!subjects[semester]) subjects[semester] = {};
    subjects[semester][name] = {frequencia:{nota:0,peso:0}, exame:{nota:0,peso:0}, trabalhos:[], tipo:tipo};
    saveData();
    renderSubjects();
}

function removeSubject(name) {
    if(!confirm(`Eliminar ${name}?`)) return;
    const semester = document.getElementById('semester-select').value;
    delete subjects[semester][name];
    saveData();
    renderSubjects();
}

function updateSubject(name, field, subfield, value) {
    const semester = document.getElementById('semester-select').value;
    subjects[semester][name][field][subfield] = parseFloat(value)||0;
    saveData();
    renderSubjects();
}

function addTrabalho(subjectName) {
    const nota = parseFloat(prompt('Nota do trabalho (0-20):'));
    const peso = parseFloat(prompt('Peso do trabalho (%):'));
    if(isNaN(nota)||isNaN(peso)) return;
    const semester = document.getElementById('semester-select').value;
    subjects[semester][subjectName].trabalhos.push({nota,peso});
    saveData();
    renderSubjects();
}

function removeTrabalho(subjectName,index) {
    const semester = document.getElementById('semester-select').value;
    subjects[semester][subjectName].trabalhos.splice(index,1);
    saveData();
    renderSubjects();
}

function calculateFinalGrade(subject) {
    const freq = (subject.frequencia.nota * subject.frequencia.peso)/100;
    const exam = (subject.exame.nota * subject.exame.peso)/100;
    const trabalhos = subject.trabalhos.reduce((sum,t)=>sum+(t.nota*t.peso)/100,0);
    return (freq+exam+trabalhos).toFixed(2);
}

function calculateNeededExamGrade(subject) {
    if(subject.exame.peso === 0) return null;
    const freq = (subject.frequencia.nota * subject.frequencia.peso)/100;
    const trabalhos = subject.trabalhos.reduce((sum,t)=>sum+(t.nota*t.peso)/100,0);
    const notaMinima = 10;
    const notaNecessaria = ((notaMinima - freq - trabalhos) * 100) / subject.exame.peso;
    return notaNecessaria;
}
function renderSubjects() {
    const semester = document.getElementById('semester-select').value;
    const container = document.getElementById('subjects-container');
    const currentSubjects = subjects[semester] || {};
    const names = Object.keys(currentSubjects);
    if(names.length===0){
        container.innerHTML = `<div class="empty-state">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"/>
            </svg>
            <p>Nenhuma cadeira adicionada neste semestre</p>
        </div>`;
        return;
    }
    container.innerHTML = names.map(name=>{
        const s = currentSubjects[name];
        if(!s.tipo) s.tipo = 'semestral';
        const notaFinal = calculateFinalGrade(s);
        const passed = parseFloat(notaFinal)>=10;
        const notaNecessaria = calculateNeededExamGrade(s);
        let exameInfo = '';
      if(notaNecessaria !== null && s.exame.peso > 0 && (s.exame.nota === 0) && (s.frequencia.nota > 0 || s.frequencia.peso > 0 || s.trabalhos.length > 0)){
            if(notaNecessaria <= 20 && notaNecessaria >= 0){
                exameInfo = `<div style="background:#fef3c7; color:#92400e; padding:12px; border-radius:8px; margin-top:10px; border-left:4px solid #f59e0b;">
                    <strong>ğŸ“Š Nota necessÃ¡ria no exame:</strong> ${notaNecessaria.toFixed(2)} valores
                </div>`;
            } else if(notaNecessaria > 20){
                exameInfo = `<div style="background:#fee2e2; color:#991b1b; padding:12px; border-radius:8px; margin-top:10px; border-left:4px solid #ef4444;">
                    <strong>âš ï¸ ImpossÃ­vel passar:</strong> Seria necessÃ¡rio ${notaNecessaria.toFixed(2)} valores (mÃ¡ximo Ã© 20)
                </div>`;
            } else {
                exameInfo = `<div style="background:#d1fae5; color:#065f46; padding:12px; border-radius:8px; margin-top:10px; border-left:4px solid #10b981;">
                    <strong>âœ… JÃ¡ passou!</strong> JÃ¡ tem nota suficiente sem o exame
                </div>`;
            }
        }
        return `<div class="subject-card">
            <div class="subject-header">
                <h3>${name} <span style="font-size:0.7em; background:${s.tipo==='anual'?'#fbbf24':'#60a5fa'}; color:white; padding:4px 10px; border-radius:12px; margin-left:10px;">${s.tipo==='anual'?'ğŸ“… ANUAL':'ğŸ“† SEMESTRAL'}</span></h3>
                <div class="grade-display">
                    <div class="final-grade ${passed?'grade-pass':'grade-fail'}">${notaFinal}</div>
                    <button class="btn btn-danger" onclick="removeSubject('${name}')">ğŸ—‘ï¸</button>
                </div>
            </div>
            ${exameInfo}
            <div class="subject-grid">
                <div class="subject-section">
                    <h4>Teste de FrequÃªncia</h4>
                    <div class="input-group">
                        <label>Nota (0-20)</label>
                        <input type="number" min="0" max="20" step="0.1" value="${s.frequencia.nota}" onchange="updateSubject('${name}','frequencia','nota',this.value)">
                    </div>
                    <div class="input-group">
                        <label>Peso (%)</label>
                        <input type="number" min="0" max="100" value="${s.frequencia.peso}" onchange="updateSubject('${name}','frequencia','peso',this.value)">
                    </div>
                </div>
                <div class="subject-section">
                    <h4>Exame</h4>
                    <div class="input-group">
                        <label>Nota (0-20)</label>
                        <input type="number" min="0" max="20" step="0.1" value="${s.exame.nota}" onchange="updateSubject('${name}','exame','nota',this.value)">
                    </div>
                    <div class="input-group">
                        <label>Peso (%)</label>
                        <input type="number" min="0" max="100" value="${s.exame.peso}" onchange="updateSubject('${name}','exame','peso',this.value)">
                    </div>
                </div>
                <div class="subject-section">
                    <h4>Trabalhos</h4>
                    <div class="trabalhos-list">
                        ${s.trabalhos.map((t,i)=>`<div class="trabalho-item">
                                <span>${t.nota} (${t.peso}%)</span>
                                <button class="btn btn-danger" onclick="removeTrabalho('${name}',${i})">ğŸ—‘ï¸</button>
                            </div>`).join('')}
                    </div>
                    <button class="btn btn-primary" onclick="addTrabalho('${name}')">+ Adicionar Trabalho</button>
                </div>
            </div>
        </div>`;
    }).join('');
}

function saveFinances() {
    finances.propinaMensal = parseFloat(document.getElementById('propina-mensal').value)||0;
    finances.mesesTotais = parseInt(document.getElementById('meses-totais').value)||0;
    finances.mesesPagos = parseInt(document.getElementById('meses-pagos').value)||0;
    saveData();
    renderFinances();
}

function toggleMaterialForm() {
    const form = document.getElementById('material-form');
    const isVisible = form.style.display !== 'none';
    form.style.display = isVisible ? 'none' : 'block';
    if(!isVisible) {
        document.getElementById('new-material-nome').value = '';
        document.getElementById('new-material-preco').value = '';
        document.getElementById('new-material-qtd').value = '1';
    }
}

function saveNewMaterial() {
    const nome = document.getElementById('new-material-nome').value.trim();
    const preco = parseFloat(document.getElementById('new-material-preco').value);
    const quantidade = parseInt(document.getElementById('new-material-qtd').value);
    const mes = parseInt(document.getElementById('new-material-mes').value);
    const semana = parseInt(document.getElementById('new-material-semana').value);
    if(!nome) {alert('Por favor, insere o nome do gasto'); return;}
    if(isNaN(preco) || preco <= 0) {alert('Por favor, insere um preÃ§o vÃ¡lido'); return;}
    if(isNaN(quantidade) || quantidade < 1) {alert('Por favor, insere uma quantidade vÃ¡lida'); return;}
    finances.materialEscolar.push({nome, preco, quantidade, mes, semana});
    saveData();
    toggleMaterialForm();
    renderFinances();
}

function applyFilters() {
    const mes = document.getElementById('filter-mes').value;
    const semana = document.getElementById('filter-semana').value;
    renderFinances(mes ? parseInt(mes) : null, semana ? parseInt(semana) : null);
}

function clearFilters() {
    document.getElementById('filter-mes').value = '';
    document.getElementById('filter-semana').value = '';
    renderFinances();
}

function renderFinances(filtroMes=null, filtroSemana=null) {
    document.getElementById('propina-mensal').value = finances.propinaMensal;
    document.getElementById('meses-totais').value = finances.mesesTotais;
    document.getElementById('meses-pagos').value = finances.mesesPagos;

    const totalPago = finances.propinaMensal * finances.mesesPagos;
    const restante = finances.propinaMensal * (finances.mesesTotais - finances.mesesPagos);
    const progresso = finances.mesesTotais>0 ? Math.round((finances.mesesPagos/finances.mesesTotais)*100) : 0;

    document.getElementById('total-pago').innerText = totalPago.toFixed(2)+' kz';
    document.getElementById('restante-pagar').innerText = restante.toFixed(2)+' kz';
    document.getElementById('progresso').innerText = progresso+'%';

    let materiais = finances.materialEscolar;
    if(filtroMes) materiais = materiais.filter(m=>m.mes===filtroMes);
    if(filtroSemana) materiais = materiais.filter(m=>m.semana===filtroSemana);

    const materialList = document.getElementById('material-list');
    materialList.innerHTML = materiais.length===0
        ? `<div class="empty-state"><p>ğŸ“¦ Nenhum gasto registado</p></div>`
        : materiais.map((m,i)=>`
            <div class="material-item">
                <div class="material-info">
                    <h4>${m.nome}</h4>
                    <p>ğŸ’° ${m.preco.toFixed(2)} kz Ã— ${m.quantidade}</p>
                    <p>ğŸ“… MÃªs ${m.mes} â€” Semana ${m.semana}</p>
                    <p><strong>${(m.preco*m.quantidade).toFixed(2)} kz</strong></p>
                </div>
                <button class="btn btn-danger" onclick="removeMaterial(${i})">ğŸ—‘ï¸</button>
            </div>`).join('');

    const totalMaterial = materiais.reduce((s,m)=>s+m.preco*m.quantidade,0);
    document.getElementById('total-material').innerText = totalMaterial.toFixed(2)+' kz';
    document.getElementById('total-gasto').innerText = (totalPago+totalMaterial).toFixed(2)+' kz';
    document.getElementById('total-previsto').innerText =
        ((finances.propinaMensal*finances.mesesTotais)+totalMaterial).toFixed(2)+' kz';
}

function removeMaterial(index){
    if(!confirm('Eliminar este gasto?')) return;
    finances.materialEscolar.splice(index,1);
    saveData();
    renderFinances();
}

function getAllSubjectsWithGrade() {
    let allSubjects = [];
    for (const semester in subjects) {
        if (subjects.hasOwnProperty(semester)) {
            for (const name in subjects[semester]) {
                if (subjects[semester].hasOwnProperty(name)) {
                    const s = subjects[semester][name];
                    const notaFinal = parseFloat(calculateFinalGrade(s));
                    allSubjects.push({
                        semester: parseInt(semester),
                        name: name,
                        nota: notaFinal,
                        passed: notaFinal >= 10
                    });
                }
            }
        }
    }
    return allSubjects;
}

function calculateEstatisticas() {
    const allSubjects = getAllSubjectsWithGrade();
    const totalSubjects = allSubjects.length;

    if (totalSubjects === 0) {
        return {
            mediaGeral: '0.00',
            aprovadas: 0,
            reprovadas: 0,
            melhorCadeira: 'N/A',
            piorCadeira: 'N/A',
            progressoSemestre: {}
        };
    }

    // MÃ©dia Geral
    const totalNotas = allSubjects.reduce((sum, s) => sum + s.nota, 0);
    const mediaGeral = (totalNotas / totalSubjects).toFixed(2);

    // Aprovadas vs Reprovadas
    const aprovadas = allSubjects.filter(s => s.passed).length;
    const reprovadas = totalSubjects - aprovadas;

    // Melhor e Pior Cadeira
    const melhor = allSubjects.reduce((prev, current) => (prev.nota > current.nota) ? prev : current, { nota: -1 });
    const pior = allSubjects.reduce((prev, current) => (prev.nota < current.nota) ? prev : current, { nota: 21 });
    
    // Progresso por Semestre
    const progressoSemestre = {};
    for (let i = 1; i <= 8; i++) {
        const semesterSubjects = allSubjects.filter(s => s.semester === i);
        if (semesterSubjects.length > 0) {
            const sum = semesterSubjects.reduce((acc, s) => acc + s.nota, 0);
            progressoSemestre[i] = (sum / semesterSubjects.length).toFixed(2);
        }
    }

    return {
        mediaGeral,
        aprovadas,
        reprovadas,
        melhorCadeira: melhor.nota !== -1 ? `${melhor.name} (${melhor.nota.toFixed(2)})` : 'N/A',
        piorCadeira: pior.nota !== 21 ? `${pior.name} (${pior.nota.toFixed(2)})` : 'N/A',
        progressoSemestre,
        detalhada: allSubjects.sort((a,b) => b.nota - a.nota) // Ordena do maior para o menor
    };
}

function renderEstatisticas() {
    const stats = calculateEstatisticas();

    // 1. Renderizar os dados principais
    document.getElementById('est-media-geral').innerText = stats.mediaGeral;
    document.getElementById('est-aprov-reprov').innerText = `${stats.aprovadas} / ${stats.reprovadas}`;
    document.getElementById('est-melhor-cadeira').innerText = stats.melhorCadeira;
    document.getElementById('est-pior-cadeira').innerText = stats.piorCadeira;

    // 2. Renderizar o Progresso Visual por Semestre
    const progressoContainer = document.getElementById('est-progresso-semestre');
    progressoContainer.innerHTML = '';
    const semesterKeys = Object.keys(stats.progressoSemestre).sort(); // Garante a ordem 1, 2, 3...
    
    if (semesterKeys.length === 0) {
        progressoContainer.innerHTML = `<div class="empty-state">
Â  Â  Â  Â  Â  Â  <p>Adicione cadeiras para ver o seu progresso por semestre.</p>
Â  Â  Â  Â  </div>`;
    } else {
        semesterKeys.forEach(semester => {
            const media = parseFloat(stats.progressoSemestre[semester]);
            const percentage = Math.min(100, (media / 20) * 100).toFixed(0); // Max 100%
            const barWidth = Math.min(100, media * 5).toFixed(0); // 20 valores = 100%
            const color = media >= 10 ? '#667eea' : '#ef4444'; // Cor baseada na mÃ©dia (Azul/Vermelho)

            const html = `
                <div class="semester-progress-item">
                    <div class="progress-label">${semester}Âº Semestre:</div>
                    <div class="progress-bar-container" style="flex-grow:1;">
                        <div class="progress-bar" style="width:${barWidth}%; background-color:${color};">
                            ${media.toFixed(2)}
                        </div>
                    </div>
                </div>
            `;
            progressoContainer.innerHTML += html;
        });
    }

    // 3. Renderizar EstatÃ­sticas Detalhadas (Lista de Cadeiras)
    const detalhadaContainer = document.getElementById('est-detalhada');
    detalhadaContainer.innerHTML = stats.detalhada.length === 0
        ? `<div class="empty-state"><p>Nenhuma cadeira encontrada.</p></div>`
        : stats.detalhada.map(s => {
            const gradeClass = s.passed ? 'pass' : 'fail';
            return `
                <div class="estatistica-item">
                    <span>${s.name} (${s.semester}Âº Semestre)</span>
                    <span class="grade ${gradeClass}">${s.nota.toFixed(2)}</span>
                </div>
            `;
        }).join('');
}

loadData();
</script>
</body>
</html>